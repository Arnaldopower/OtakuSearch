{% include "base.html" with include_header=True %}
<!DOCTYPE html>

<body>
    <iframe id="animeVideo" width="420" height="315"></iframe>
    <img id="animeImage" width="420" height="315"></img>

    <script>
        let embedUrl, embedImg

        function getAnimeVideo(idAnime) {
            fetch('https://api.jikan.moe/v4/anime/'+idAnime+'/videos')
                .then(response => {
                    if (!response.ok) {
                        throw new Error("Error en la connexio suicidet")
                    }
                    return response.json()
                })
                .then (data => {
                    embedUrl = data["data"]['promo'][0]['trailer']['embed_url']
                    renderVideo(embedUrl, document.getElementById('animeVideo'))
                })
                .catch (error => (console.log("Error otra vez, matet: ", error)))
        }

        function getAnimeImage(idAnime) {
            fetch('https://api.jikan.moe/v4/anime/'+idAnime+'/pictures')
                .then(response => {
                    if (!response.ok) {
                        throw new Error("Error en la connexio suicidet")
                    }
                    return response.json()
                })
                .then (data => {
                    console.log(data)
                    embedImg = data["data"][0]['jpg']['image_url']
                    renderImage(embedImg, document.getElementById('animeImage'))
                })
                .catch (error => (console.log("Error otra vez, matet: ", error)))
        }

        function renderVideo(embedUrl, iframe) {
            iframe.src = embedUrl
        }

        function renderImage(embedImg, img) {
            img.src = embedImg
        }

        embedUrl = getAnimeVideo(49458)
        embedImg = getAnimeImage(49458)
    </script>

</body>